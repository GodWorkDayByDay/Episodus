<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>TIdThreadSafeStringList</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META name="GENERATOR" content="Doc-O-Matic">
    <LINK rel="STYLESHEET" href="default.css" type="text/css">

<SCRIPT LANGUAGE="JavaScript1.2" SRC="scripts.js"></SCRIPT>
</HEAD>
<BODY CLASS="Element57">
<TABLE BORDER="0" BGCOLOR="#AACCFF" WIDTH="100%" CELLSPACING="0" CELLPADDING="0">
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">
<DIV CLASS="Element1">
Indy 9</DIV>
</TD><TD VALIGN="MIDDLE" ALIGN="LEFT">
<DIV CLASS="Element2">
<A HREF="content.html" CLASS="Element59">Content</A> | <A HREF="idx.html" CLASS="Element59">Index</A> | <A HREF="symref.html" CLASS="Element59">Reference</A></DIV>
</TD></TR></TABLE><DIV CLASS="Element58">
<DIV CLASS="Element5">
TIdThreadSafeStringList</DIV>
<DIV CLASS="Element7">
<A HREF="014486.html" CLASS="Element59">Hierarchy</A>, <A HREF="014487.html" CLASS="Element59">Methods</A>, <A HREF="014488.html" CLASS="Element59">See Also</A>, <A HREF="002930.html" CLASS="Element59">Unit: IdThreadSafe</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Implements a thread-safe TStringList data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12">TIdThreadSafeStringList = <STRONG>class</STRONG>(<A HREF="007857.html" CLASS="Element59">TIdThreadSafe</A>)</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Unit</DIV>
<DIV CLASS="Element69">
<A HREF="002930.html" CLASS="Element59">IdThreadSafe</A></DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
TIdThreadSafeStringList is a <A HREF="007857.html" CLASS="Element59">TIdThreadSafe</A> descendant that implements a thread-safe data type for storing TStringList values. TIdThreadSafeStringList relies on the inherited TCriticalSection for resource protection in multi-threaded applications. TIdThreadSafeStringList implements procedures and functions that provide read and write access to the values in the internal TStringList with resource protection.<P CLASS="Element10">
Use <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to acquire a protected copy of the resource-protected TStringList, and <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to release the resource-protected value. <STRONG>Note</STRONG>: Access to values in the instance are blocked to other threads until <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> is called.<P CLASS="Element10">
Use <A HREF="007862.html#0000" CLASS="Element59">Add</A> or <A HREF="007862.html#0001" CLASS="Element59">AddObject</A> to add a new value(s) to the resource-protected TStringList.<P CLASS="Element10">
Use <A HREF="007862.html#0006" CLASS="Element59">ObjectByItem</A> to retrieve an Object in the resource-protected TStringList using the associated String value.<P CLASS="Element10">
Use <A HREF="007862.html#0002" CLASS="Element59">Clear</A> to remove all values in the resource-protected TStringList.<P CLASS="Element10">
Use <A HREF="007862.html#0007" CLASS="Element59">Remove</A> to locate and delete a value in the resource-protected TStringList using the associated String value.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0000">TIdThreadSafeStringList.Add</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014489.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Adds a string value to the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Add(<STRONG>const</STRONG> AItem: <STRONG>string</STRONG>);</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const AItem: string</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
String value added to the data type.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Add is a procedure used to add the String value in AItem to the Value for the thread-safe TStringList data type. Add calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection for Value prior to adding the contents of AItem to the thread-safe data type. Adds calls <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection for Value when AItem has been added, or an exception is raised.<P CLASS="Element10">
Use <A HREF="007862.html#0001" CLASS="Element59">AddObject</A> to add a string with an associated TObject instance to the thread-safe data type.<P CLASS="Element10">
Use <A HREF="007862.html#0007" CLASS="Element59">Remove</A> or <A HREF="007862.html#0002" CLASS="Element59">Clear</A> to delete one or all items in the thread-safe data type.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0001">TIdThreadSafeStringList.AddObject</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014490.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Adds a string value and an associated object instance to the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> AddObject(<STRONG>const</STRONG> AItem: <STRONG>string</STRONG>; AObject: TObject);</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const AItem: string</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
String value added to the data type.</DIV>
</DIV>
<DIV CLASS="Element17">
AObject: TObject</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Object instance added to the data type.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
AddObject is a procedure used to add the String in AItem and the TObject instance in AObject to the items in Value for the thread-safe TStringList data type. AddObject calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection for Value prior to adding the item and object to the thread-safe data type. Adds calls <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection for Value when the item and onbject have been added, or an exception is raised.<P CLASS="Element10">
Use <A HREF="007862.html#0000" CLASS="Element59">Add</A> to add a string to the items in the thread-safe data type.<P CLASS="Element10">
Use <A HREF="007862.html#0007" CLASS="Element59">Remove</A> or <A HREF="007862.html#0002" CLASS="Element59">Clear</A> to delete one or all items in the thread-safe data type.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0002">TIdThreadSafeStringList.Clear</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014491.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Deletes all items in the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Clear;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Clear is a procedure used to remove all items in Value for the thread-safe TStringList data type. Clear calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection for Value prior to removing items in Value for the thread-safe data type. Clear calls <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection for Value when items in Value have been deleted, or an exception is raised.<P CLASS="Element10">
Use <A HREF="007862.html#0007" CLASS="Element59">Remove</A> to delete a single item in Value from the thread-safe data type.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0003">TIdThreadSafeStringList.Create</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014492.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Constructor for the object instance.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>constructor</STRONG> Create(<STRONG>const</STRONG> ASorted: Boolean = False); <STRONG>reintroduce</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const ASorted: Boolean = False</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Indicates that items in the data type value are sorted alphabetically.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Create is the constructor for the thread-safe data type object instance. Create calls the inherited Create method prior to allocating the TStringList used in the Value property. Create also sets the Sorted property in Value to the parameter ASorted.<P CLASS="Element10">
Use Free to release the thread-safe data type object instance.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0004">TIdThreadSafeStringList.Destroy</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014493.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Frees the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>destructor</STRONG> Destroy; <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Destroy is the destructor for the thread-safe data type object instance. Destroy calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection while resources allocated to Value in the <A HREF="007862.html#0003" CLASS="Element59">Create</A> method are freed. Destroy call <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection on successful completion, or when an exception is raised. The inherited Destroy method is called prior to exit.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0005">TIdThreadSafeStringList.Lock</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014494.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Enables resource protection and returns the current value for the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>function</STRONG> Lock: TStringList; <STRONG>reintroduce</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Return Value</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
TStringList - Contents of the Value for the data type.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Lock is a TStringList function used enable resource protection for the thread-safe data type, and return the current contents of Value. Lock is re-introduced in <A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A> to provide the TStringList return value for the data type. Lock calls the inherited Lock method, and sets the return value to Value.<P CLASS="Element10">
Use <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable the resource protection capabilities of the thread-safe data type.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0006">TIdThreadSafeStringList.ObjectByItem</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014495.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Retrieves an object instance by an associated item value.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>function</STRONG> ObjectByItem(<STRONG>const</STRONG> AItem: <STRONG>string</STRONG>): TObject;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const AItem: string</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Value in Items used to locate the object instance.</DIV>
</DIV>
<DIV CLASS="Element14">
Return Value</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
TObject - Object instance associated with the item value, or Nil.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
ObjectByItem is a TObject function used to retrieve an object instance from the thread-safe data type using the associated item value specified in AItem. ObjectByItem calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection while items in Value are searched using it's IndexOf method. The return value for the method is Nil when AItem cannot be found in the item values in Value. ObjectByItem call <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection on successful completion, or when an exception is raised.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0007">TIdThreadSafeStringList.Remove</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014496.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Deletes a string value from the items in the thread-safe data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Remove(<STRONG>const</STRONG> AItem: <STRONG>string</STRONG>);</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const AItem: string</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
String value to remove from the data type.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Remove is a procedure used to delete the String value in AItem from the Value for the thread-safe TStringList data type. Remove calls <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable resource protection for Value prior to searching Value using it's IndedxOf method. When AItems exists in Value, it is deleted. Remove calls <A HREF="007862.html#0008" CLASS="Element59">Unlock</A> to disable resource protection for Value when AItem has been deleted, or an exception is raised.<P CLASS="Element10">
Use <A HREF="007862.html#0000" CLASS="Element59">Add</A> to add a string value to the thread-safe data type.<P CLASS="Element10">
Use <A HREF="007862.html#0001" CLASS="Element59">AddObject</A> to add a string with an associated TObject instance to the thread-safe data type.<P CLASS="Element10">
Use <A HREF="007862.html#0002" CLASS="Element59">Clear</A> to delete all items in the thread-safe data type.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0008">TIdThreadSafeStringList.Unlock</A></DIV>
<DIV CLASS="Element7">
<A HREF="007862.html" CLASS="Element59">TIdThreadSafeStringList</A>, <A HREF="014497.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Disables resource protection for the associated data type.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Unlock; <STRONG>reintroduce</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Unlock is a procedure used to disengage the resource protection capabilities of the class for the associated data type. Unlock calls the inherited method that executes the TCriticalSection.Leave method to disable the resource protection block. Use <A HREF="007862.html#0005" CLASS="Element59">Lock</A> to enable the resource protection block for the class instance.</DIV>
</DIV>
<DIV CLASS="Element62">
<HR>Created with Doc-O-Matic 2 donated to <STRONG><A HREF="http://www.delphi-jedi.org">Project JEDI</A></STRONG>. Commercial license available from the <STRONG><A HREF="http://www.doc-o-matic.com">Doc-O-Matic site</A></STRONG>.</DIV>
</DIV></BODY></HTML>
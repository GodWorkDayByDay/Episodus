<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>TIdSMTP</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META name="GENERATOR" content="Doc-O-Matic">
    <LINK rel="STYLESHEET" href="default.css" type="text/css">

<SCRIPT LANGUAGE="JavaScript1.2" SRC="scripts.js"></SCRIPT>
</HEAD>
<BODY CLASS="Element57">
<TABLE BORDER="0" BGCOLOR="#AACCFF" WIDTH="100%" CELLSPACING="0" CELLPADDING="0">
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">
<DIV CLASS="Element1">
Indy 9</DIV>
</TD><TD VALIGN="MIDDLE" ALIGN="LEFT">
<DIV CLASS="Element2">
<A HREF="content.html" CLASS="Element59">Content</A> | <A HREF="idx.html" CLASS="Element59">Index</A> | <A HREF="symref.html" CLASS="Element59">Reference</A></DIV>
</TD></TR></TABLE><DIV CLASS="Element58">
<DIV CLASS="Element5">
TIdSMTP</DIV>
<DIV CLASS="Element7">
<A HREF="013561.html" CLASS="Element59">Hierarchy</A>, <A HREF="013562.html" CLASS="Element59">Properties</A>, <A HREF="013563.html" CLASS="Element59">Methods</A>, <A HREF="013564.html" CLASS="Element59">Events</A>, <A HREF="013565.html" CLASS="Element59">See Also</A>, <A HREF="002818.html" CLASS="Element59">Unit: IdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Implements a Simple Mail Transfer Protocol client.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12">TIdSMTP = <STRONG>class</STRONG>(<A HREF="007546.html" CLASS="Element59">TIdMessageClient</A>)</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Unit</DIV>
<DIV CLASS="Element69">
<A HREF="002818.html" CLASS="Element59">IdSMTP</A></DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
TIdSMTP is a <A HREF="007546.html" CLASS="Element59">TIdMessageClient</A> descendant that implements a Simple Mail Transfer Protocol or SMTP client, as described in the Internet Standards documents:<P CLASS="Element10">
<UL>
<LI>RFC 821 - Simple Mail Transfer Protocol [SMTP] (http://www.rfc-editor.org/rfc/rfc821.txt)<P CLASS="Element10">
<LI>RFC 1869 - SMTP Service Extensions (http://www.rfc-editor.org/rfc/rfc1869.txt)<P CLASS="Element10">
<LI>RFC 2554 - SMTP Service Extension for Authentication (http://www.rfc-editor.org/rfc/rfc2554.txt)</UL>
<P CLASS="Element10">
Use <A HREF="007617.html" CLASS="Element59">TIdPOP3</A> or <A HREF="007405.html" CLASS="Element59">TIdIMAP4</A> to retrieve E-Mail messages from a mail server to the user's computer.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0002">TIdSMTP.AuthenticationType</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Authentication type required to <A HREF="000295.html" CLASS="Element59">connect</A> to the SMTP host.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> AuthenticationType: <A HREF="007137.html" CLASS="Element59">TAuthenticationType</A>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
AuthenticationType is a <A HREF="007137.html" CLASS="Element59">TAuthenticationType</A> property that specifies the authentication type to use when accessing the E-Mail server. AuthenticationType can contain one of the following values:<P CLASS="Element10">
<UL>
<LI>atNone - no authentication is required.<P CLASS="Element10">
<LI>atLogin - simple username and password authentication is required (AUTH LOGIN).</UL>
<P CLASS="Element10">
You can find the authentication mechanisms supported on the E-Mail server identified in Host by using <A HREF="007701.html#0003" CLASS="Element59">AuthSchemesSupported</A>.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0003">TIdSMTP.AuthSchemesSupported</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
List of supported authentication methods for the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> AuthSchemesSupported: TStringList;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
AuthSchemesSupported is a read-only TStringList property that contains the authentication methods supported by an SMTP Mail server. AuthSchemesSupported is valid only when you are connected to the server. Set <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> to the appropriate value for one of the authentication schemes supported on the SMTP server.<P CLASS="Element10">
<STRONG>Note</STRONG>: Any given SMTP server can support authentication mechanisms which may not be implemented in <A HREF="007701.html" CLASS="Element59">TIdSMTP</A>.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0009">TIdSMTP.HeloName</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013566.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Identities the client connecting to an SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> HeloName: <STRONG>string</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
HeloName is a String property that represents the identity name of the client establishing a connection to the SMTP server using either the SMTP EHLO or HELO command verbs. HeloName is used in <A HREF="007701.html#0004" CLASS="Element59">Connect</A> to hail the SMTP server. when HeloName contains a blank value, LocalName is used when hailing the SMTP server.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000A">TIdSMTP.MailAgent</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013567.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Identifies the program that created a message.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> MailAgent: <STRONG>string</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
MailAgent is a String property that identifies the name of a program used to create or transmit a message. MailAgent specifies your program name, and is placed in the SMTP 'X-Mailer' header in the <A HREF="007701.html#000D" CLASS="Element59">Send</A> method.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000B">TIdSMTP.Password</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013568.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Specifies the password used for SMTP account authentication.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> Password;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Password is a String property that specifies the password used for SMTP account authentication. <A HREF="007701.html#000F" CLASS="Element59">Username</A> and Password are used by <A HREF="007701.html#0001" CLASS="Element59">Authenticate</A> when <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> is atLogin.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000E">TIdSMTP.UseEhlo</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013569.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Indicates the SMTP client desires authetication type information from the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> UseEhlo: Boolean;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
UseEhlo is a Boolean property that indicates the SMTP client desires authetication type information from the SMTP server. When UseEhlo is True, the client will <A HREF="000295.html" CLASS="Element59">connect</A> with the SMTP EHLO greeting that instructs the server to <A HREF="006944.html" CLASS="Element59">send</A> supported authentication types after the banner greeting.<P CLASS="Element10">
UseEhlo is used in the <A HREF="007701.html#0004" CLASS="Element59">Connect</A> method prior to sending the value from <A HREF="007701.html#0009" CLASS="Element59">HeloName</A> (or LocalName) to the SMTP server. When UseEhlo is True, the client identification is sent using the SMTP EHLO command. Authentication types supported by the server are captured upon successful completion of the EHLO command. When UseEhlo is False, the SMTP HELO command is used for client identification.<P CLASS="Element10">
<STRONG>Note</STRONG>: Changing the value of UseEhlo from True to False forces the <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> property to be reset to the value atNone. An application must set the correct value for <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> after changing UseEhlo from True to False.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000F">TIdSMTP.Username</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013570.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Specifies the user account for the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>property</STRONG> Username;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Username is a String property that specifies the user name used to log on to the SMTP Server. Username and <A HREF="007701.html#000B" CLASS="Element59">Password</A> are used, in <A HREF="007701.html#0001" CLASS="Element59">Authenticate</A>, to perform account verification when <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> is atLogin.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0000">TIdSMTP.Assign</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Copies property values to the current object instance.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Assign(Source: TPersistent); <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
Source: TPersistent</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Object instance containing property values to be copied.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Assign is a procedure that allows an persistent object instance to copy property values from another persistent object instance to the current instance.<P CLASS="Element10">
Assign will load the following property values:<P CLASS="Element10">
<UL>
<LI><A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A><P CLASS="Element10">
<LI>Host<P CLASS="Element10">
<LI><A HREF="007701.html#000A" CLASS="Element59">MailAgent</A><P CLASS="Element10">
<LI><A HREF="007701.html#000B" CLASS="Element59">Password</A><P CLASS="Element10">
<LI>Port<P CLASS="Element10">
<LI><A HREF="007701.html#000F" CLASS="Element59">Username</A></UL>
</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0001">TIdSMTP.Authenticate</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Performs account authentication on the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>function</STRONG> Authenticate: Boolean; <STRONG>virtual</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Return Value</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
<STRONG>Boolean</STRONG> - True on success.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Authenticate is a Boolean function that performs account authentication on the SMTP server. Authenticate returns True when successful, or False if authentication failed.<P CLASS="Element10">
You must specify the <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> before calling the Authenticate method. Authenticate should be called only once for a SMTP session.<P CLASS="Element10">
<A HREF="007701.html#000D" CLASS="Element59">Send</A> will also call Authenticate before transmission of an E-Mail message, if the SMTP session has not been authenticated.<P CLASS="Element10">
When <A HREF="007701.html#0002" CLASS="Element59">AuthenticationType</A> is atLogin, Authenticate sends the SMTP AUTH LOGIN command followed by the Base64-encoded values for <A HREF="007701.html#000F" CLASS="Element59">Username</A> and <A HREF="007701.html#000B" CLASS="Element59">Password</A> to the server.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0004">TIdSMTP.Connect</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Opens a connection to the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Connect(<STRONG>const</STRONG> ATimeout: Integer = <A HREF="002932.html" CLASS="Element59">IdTimeoutDefault</A>); <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const ATimeout: Integer = IdTimeoutDefault</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Connection timeout in milliseconds. Default value is <A HREF="002932.html" CLASS="Element59">IdTimeoutDefault</A>.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Connect is a procedure that opens a connection to the SMTP server using the Host and Port properties. An exception will be raised if the connection fails or returns an invalid SMTP response code.<P CLASS="Element10">
After establishing the <A HREF="007071.html" CLASS="Element59">socket</A> connection, Connect will clear <A HREF="007701.html#0003" CLASS="Element59">AuthSchemesSupported</A>. Connect hails the server using either the <A HREF="007701.html#0009" CLASS="Element59">HeloName</A> or the LocalName properties using either the SMTP EHLO or HELO commands. When the EHLO command is supported on the SMTP server, <A HREF="007701.html#0003" CLASS="Element59">AuthSchemesSupported</A> will be loaded.<P CLASS="Element10">
If an exception is raised in Connect, the SMTP client will call <A HREF="007701.html#0007" CLASS="Element59">Disconnect</A> and the exception will be re-raised.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0005">TIdSMTP.Create</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013571.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Constructor for the object instance.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>constructor</STRONG> Create(AOwner: TComponent); <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
AOwner: TComponent</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Owner of the object instance.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Create is the constructor for the object instance. Create initializes <A HREF="007701.html#0003" CLASS="Element59">AuthSchemesSupported</A> to ignore duplicate entries, and sets Port to the default SMTP port number (<A HREF="002679.html" CLASS="Element59">IdPORT_SMTP</A>).</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0006">TIdSMTP.Destroy</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013572.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Frees the object instance.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>destructor</STRONG> Destroy; <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Destroy is the destructor for the object instance. Destroy clears and releases the <A HREF="007701.html#0003" CLASS="Element59">AuthSchemesSupported</A> property prior to calling the inherited Destroy method.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0007">TIdSMTP.Disconnect</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Closes the SMTP session.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Disconnect; <STRONG>override</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Disconnect is a procedure that closes the SMTP session. When Connected is True, the SMTP QUIT command is used to inform the server that the session will be ended. Disconnect calls the inherited Disconnect method, and indicates that the SMTP session has not been previously authenticated.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0008">TIdSMTP.Expand</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013573.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Determines group membership for a mailing list or mailbox alias.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Expand(AUserName: <STRONG>String</STRONG>; AResults: TStrings); <STRONG>virtual</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
AUserName: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Mail list or alias to be expanded.</DIV>
</DIV>
<DIV CLASS="Element17">
AResults: TStrings</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Membership in the list or alias.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Expand is a procedure used to determine if the argument in AUsername is a valid mailing list or mailbox alias on the server, and retrieve the email addresses for the membership of that list in AResults. Expand uses the SMTP EXPN command to retrieve the results, with one name and email address per line.<P CLASS="Element10">
The following is an example of successful result values that might be returned in AResults when using Expand with the <A HREF="007701.html#000F" CLASS="Element59">Username</A> 'Example-People':<P CLASS="Element10">
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12">    Jon Postel 
    Fred Fonebone 
    Sam Q. Smith 
    Quincy Smith &lt;@USC-ISIF.ARPA:Q-Smith@ISI-VAXA.ARPA&gt;
    
    </PRE></DIV>
</DIV>
<P CLASS="Element10">
Use <A HREF="007701.html#0010" CLASS="Element59">Verify</A> to validate an individual name or address on the SMTP server.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000C">TIdSMTP.QuickSend</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Sends a message without an Indy message instance.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>class</STRONG> <STRONG>procedure</STRONG> QuickSend(<STRONG>const</STRONG> AHost: <STRONG>String</STRONG>; <STRONG>const</STRONG> ASubject: <STRONG>String</STRONG>; <STRONG>const</STRONG> ATo: <STRONG>String</STRONG>; <STRONG>const</STRONG> AFrom: <STRONG>String</STRONG>; <STRONG>const</STRONG> AText: <STRONG>String</STRONG>);</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
const AHost: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
SMTP server used to <A HREF="006944.html" CLASS="Element59">send</A> the message.</DIV>
</DIV>
<DIV CLASS="Element17">
const ASubject: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Subject of the message.</DIV>
</DIV>
<DIV CLASS="Element17">
const ATo: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Recipient(s) of the message.</DIV>
</DIV>
<DIV CLASS="Element17">
const AFrom: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Person sending the message.</DIV>
</DIV>
<DIV CLASS="Element17">
const AText: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Body text for the message.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
QuickSend is a class procedure that allows the SMTP client to quickly <A HREF="006944.html" CLASS="Element59">send</A> a message without the need for a <A HREF="007544.html" CLASS="Element59">TIdMessage</A> instance. QuickSend cannot be used to <A HREF="006944.html" CLASS="Element59">send</A> messages with attachments. Use <A HREF="007701.html#000D" CLASS="Element59">Send</A> to transfer messages that include attachments.<P CLASS="Element10">
Parameters for the method are used to construct a <A HREF="007544.html" CLASS="Element59">TIdMessage</A> instance, <A HREF="000295.html" CLASS="Element59">connect</A> and <A HREF="006944.html" CLASS="Element59">send</A> the message to the SMTP server, and to <A HREF="007701.html#0007" CLASS="Element59">Disconnect</A> from the SMTP server. The following is an example of using QuickSend with pre-defined application variables:<P CLASS="Element10">
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12">  try
    ASmtp.QuickSend(SMailhost, SSubject, SUserAccount,
      SContactAccount, ABody.Text);
  except on E:
    do DoReminderTransmitError(E);
  end;</PRE></DIV>
</DIV>
</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="000D">TIdSMTP.Send</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Sends an Indy message instance to the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>procedure</STRONG> Send(AMsg: <A HREF="007544.html" CLASS="Element59">TIdMessage</A>); <STRONG>virtual</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
AMsg: TIdMessage</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Message instance to be transmitted.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Send is a procedure that sends the <A HREF="007544.html" CLASS="Element59">TIdMessage</A> specified in AMsg using the SMTP server specified in the Host property. Send will reset the SMTP session, and call <A HREF="007701.html#0001" CLASS="Element59">Authenticate</A> when the SMTP session has never been authenticated.<P CLASS="Element10">
Send transmits RFC 822 message headers to the SMTP server, including From, Recipients, Carbon-Copy recipients, and Blind Carbon-Copy recipients before sending the data and extra RFC 822 message headers for the message. Send inserts the value in <A HREF="007701.html#000A" CLASS="Element59">MailAgent</A> header as the first values in the data for the message. Send terminates transfer of data to the SMTP server using the '.' end-of-transmission marker.</DIV>
</DIV>
<HR><DIV CLASS="Element6">
<A NAME="0010">TIdSMTP.Verify</A></DIV>
<DIV CLASS="Element7">
<A HREF="007701.html" CLASS="Element59">TIdSMTP</A>, <A HREF="013574.html" CLASS="Element59">See Also</A></DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Verifies that an alias or name is a user mailbox on the SMTP server.</DIV>
</DIV>
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12"><STRONG>function</STRONG> Verify(AUserName: <STRONG>String</STRONG>): <STRONG>String</STRONG>; <STRONG>virtual</STRONG>;</PRE></DIV>
</DIV>
<DIV CLASS="Element14">
Parameters</DIV>
<DIV CLASS="Element17">
AUserName: String</DIV>
<DIV CLASS="Element18">
<DIV CLASS="Element19">
Value to be verified.</DIV>
</DIV>
<DIV CLASS="Element14">
Return Value</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
String - Fully qualified User name and email address.</DIV>
</DIV>
<DIV CLASS="Element14">
Description</DIV>
<DIV CLASS="Element11">
<DIV CLASS="Element10">
Verify is a String function used to verify that the User specified in AUsername is a valid address on the SMTP server. Verify returns the fully sepecified User name and email address on success. Use <A HREF="007701.html#0008" CLASS="Element59">Expand</A> to determine the membership in a mailing list.<P CLASS="Element10">
The following is an example of the value returned from a successful Verify command request using 'Smith' in AUsername:<P CLASS="Element10">
<DIV CLASS="Element13">
<DIV CLASS="Element12">
<PRE CLASS="Element12">    Fred Smith </PRE></DIV>
</DIV>
</DIV>
</DIV>
<DIV CLASS="Element62">
<HR>Created with Doc-O-Matic 2 donated to <STRONG><A HREF="http://www.delphi-jedi.org">Project JEDI</A></STRONG>. Commercial license available from the <STRONG><A HREF="http://www.doc-o-matic.com">Doc-O-Matic site</A></STRONG>.</DIV>
</DIV></BODY></HTML>